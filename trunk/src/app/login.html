<!DOCTYPE html>
<html lang="en" class="app">
<head>
	<meta charset="utf-8" />

  	<title>Login octopusApp.es | Tests de oposiciones, certificaciones y más</title>
  	<meta name="author" content="Carrón Sisters"/>
  	<meta name="theme-color" content="#25313e">

  	<meta name="description" content="octopusapp.es, tests, oposiciones, certificaciones, app, web app" />

  	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  	<meta content="320" name="MobileOptimized">

    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">

	<link href="images/icon144.png" sizes="144x144"  rel="apple-touch-icon-precomposed">
    <link href="images/icon114.png" sizes="114x114"  rel="apple-touch-icon-precomposed">
    <link href="images/icon72.png"  sizes="72x72"  	rel="apple-touch-icon-precomposed">
    <link href="images/icon57.png"  sizes="57x57"  	rel="apple-touch-icon-precomposed">
    <link href="images/icon57.png"    rel="shortcut icon">

	<link rel="stylesheet" href="css/bootstrap.css" type="text/css" />

	<link rel="stylesheet" href="css/font-awesome.min.css" type="text/css" />
	<link rel="stylesheet" href="css/font.css" type="text/css" />
	<link rel="stylesheet" href="css/app.css" type="text/css" />
</head>
<body class="login">
	<section>
		<div class="screens"></div>

		<a href="#" style="display:none" class="btn-mobile btn btn-google btn-primary btn-rounded"><i class="fa fa-google-plus"></i>Login con Google</a>

		<span id="signinButton" style="display:none" onclick="googleWebApi.signIn()" class="btn btn-web btn-google btn-rounded btn-danger" >
			<span
			    class="g-signin"
			    data-callback="googleWebApi.signinCallback"
			    data-clientid="893060658101-6ehddc6q9hh1d4l891on5fm1mss3fcme.apps.googleusercontent.com"
			    data-cookiepolicy="single_host_origin"
			    data-scope="https://www.googleapis.com/auth/plus.login" >

			    <i class="fa fa-google-plus"></i>Login con Google</a>
		  	</span>
		</span>

		<a style="display:none" onclick="loginSinConexion()" class="btn-no-connection btn btn-warning btn-rounded"><i class="fa fa-sign-in"></i> Entrar</a>

		<div class="throbber cargando"></div>
		<p class="status"></p>
	</section>

	<script src="js/jquery.min.js"></script>
	<script src="https://apis.google.com/js/client.js?onload=gapiInit"></script>
	<!-- <script src="js/app.js"></script> -->
	<script src="js/app.plugin.js"></script>
	<script src="js/options.nosvn.js"></script>
	

	<script src="../cordova.js"></script>
	
	<script>
		function get(s){return localStorage.getItem(s)}
		function isPhone(){
			if (document.URL.indexOf("http://") === -1 && 
				document.URL.indexOf("https://") === -1) {
				return true
				}
			else
				return false 
			}
		function prepareLoginSinConexion(){
			jQuery('body').addClass('no-connection')	
			jQuery('.status').html('<p>No se ha podido conectar con el servidor.  </p> <p>Puedes entrar y continuar con los tests que ya tengas, pero no podrás descargar nuevos.</p>')
			jQuery('.login .throbber').hide()
			}
		function loginSinConexion(){
			document.location.replace('./prod.html?noHayDatos')
			}
		function init(){
			if (navigator.connection && navigator.connection.type==Connection.NONE){
				prepareLoginSinConexion()
				return
				}
			
			if (!isPhone() ){
				if (get('tapp37_yanoshavisitado')=='1')
					setTimeout(function(){googleWebApi.signIn()}, 300)
				else{
					googleWebApi.prepareLogin()
					}
				}
			else {
				// refresh_token no funciona
				// var rt=get('tapp37_refresh_token')
				// if (rt!=null){
				// 	setTimeout(function(){googleMobileApi.prepareTokenRefresh(rt)}, 100)
				// 	}
				// else 
				if (get('tapp37_yanoshavisitado')=='1')
					setTimeout(function(){googleMobileApi.silentLogin()}, 100)
				else {
					googleMobileApi.prepareLogin()
					}
				}
			}
		if (isPhone())
          	document.addEventListener('deviceready', function(){init()}, true)
      	else
          	jQuery(document).ready(function(){init()} )
	</script>
</body>
</html>